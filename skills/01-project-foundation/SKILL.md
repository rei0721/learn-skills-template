---
name: 项目基础
description: Go Scaffold 项目的目标、边界和关键决策
category: 核心
priority: 2
dependencies: [00-project-map]
---

# 项目基础

## 职责范围

- 定义项目的目标和边界
- 记录关键技术决策和原因
- 明确项目不做的事情（Non-Goals）
- 提供项目背景和上下文

## 适用场景

- 新成员了解项目
- 评估新功能是否符合项目目标
- 技术选型决策
- 架构重构决策

## 核心规则

### 1. 项目目标

**主要目标**:
- 提供一个生产就绪的 Go Web 应用脚手架
- 实现清晰的分层架构和依赖注入模式
- 提供完整的基础设施组件（日志、缓存、数据库、认证等）
- 支持快速开发和部署

**次要目标**:
- 代码可读性和可维护性
- 组件可复用性
- 配置灵活性
- 性能优化

### 2. 项目边界

**包含的功能**:
- ✅ HTTP API 服务器
- ✅ 数据库操作（MySQL/PostgreSQL/SQLite）
- ✅ Redis 缓存
- ✅ JWT 认证
- ✅ RBAC 权限控制
- ✅ 结构化日志
- ✅ 配置管理和热重载
- ✅ 协程池管理
- ✅ 国际化支持
- ✅ 命令行工具

**不包含的功能**:
- ❌ 前端界面（纯后端项目）
- ❌ 消息队列（如 RabbitMQ, Kafka）
- ❌ 微服务架构（单体应用）
- ❌ GraphQL（仅支持 RESTful API）
- ❌ WebSocket（仅支持 HTTP）
- ❌ 定时任务调度（需要自行实现）

### 3. 关键决策

#### 决策 1: 使用 Gin 作为 Web 框架

**原因**:
- 高性能（基于 httprouter）
- 丰富的中间件生态
- 简单易用的 API
- 活跃的社区支持

**替代方案**:
- Echo: 性能相近，但生态不如 Gin
- Fiber: 性能更高，但 API 不够 Go 风格
- 标准库: 功能不够完善，需要自己实现很多功能

#### 决策 2: 使用 GORM 作为 ORM

**原因**:
- 功能完善（关联、事务、迁移等）
- 支持多种数据库
- 活跃的社区支持
- 代码生成工具

**替代方案**:
- sqlx: 更轻量，但功能不够完善
- ent: 类型安全，但学习曲线陡峭
- 原生 SQL: 灵活，但代码冗余

#### 决策 3: 使用 Zap 作为日志库

**原因**:
- 高性能（零分配）
- 结构化日志
- 灵活的配置
- Uber 出品，质量保证

**替代方案**:
- logrus: 功能丰富，但性能不如 Zap
- zerolog: 性能相近，但 API 不够友好
- 标准库: 功能不够完善

#### 决策 4: 使用 Casbin 作为权限控制

**原因**:
- 灵活的权限模型（RBAC, ABAC 等）
- 支持多种存储后端
- 活跃的社区支持
- 丰富的文档和示例

**替代方案**:
- 自己实现: 灵活，但开发成本高
- go-guardian: 功能简单，不够灵活

#### 决策 5: 使用依赖注入容器模式

**原因**:
- 集中管理组件生命周期
- 明确的依赖关系
- 便于测试（可以 mock 依赖）
- 支持配置热重载

**替代方案**:
- 全局变量: 简单，但难以测试和维护
- 依赖注入框架（如 wire, dig）: 功能强大，但增加复杂度

#### 决策 6: 使用分层架构

**原因**:
- 职责清晰
- 易于理解和维护
- 便于团队协作
- 支持独立测试

**替代方案**:
- 六边形架构: 更灵活，但复杂度高
- DDD: 适合复杂业务，但学习曲线陡峭
- MVC: 简单，但不够清晰

### 4. 非目标（Non-Goals）

**明确不做的事情**:

1. **不支持多租户**: 项目设计为单租户应用，不支持多租户隔离
2. **不支持分布式事务**: 仅支持单数据库事务，不支持跨数据库事务
3. **不支持实时通信**: 不支持 WebSocket、SSE 等实时通信协议
4. **不支持文件上传**: 不提供文件上传和存储功能（需要自行实现）
5. **不支持邮件发送**: 不提供邮件发送功能（需要自行实现）
6. **不支持短信发送**: 不提供短信发送功能（需要自行实现）
7. **不支持支付集成**: 不提供支付网关集成（需要自行实现）
8. **不支持第三方登录**: 不提供 OAuth2、OIDC 等第三方登录（需要自行实现）

**为什么不做**:
- 保持项目简洁和专注
- 避免引入过多依赖
- 降低学习成本
- 提高可维护性

**如何扩展**:
- 这些功能可以作为独立模块添加
- 参考 `pkg/` 目录下的组件实现方式
- 遵循项目的架构和设计原则

## AI 行为约束

### 必须遵守

1. **目标对齐**: 新功能必须符合项目目标
2. **边界检查**: 新功能不能超出项目边界
3. **决策尊重**: 不能违背关键技术决策
4. **非目标确认**: 不能实现非目标中的功能（除非用户明确要求）

### 禁止行为

1. **引入新框架**: 禁止引入与现有框架冲突的新框架
2. **改变架构**: 禁止改变分层架构和依赖注入模式
3. **违背决策**: 禁止违背关键技术决策
4. **超出边界**: 禁止实现超出项目边界的功能

### 违规处理

- 检测到目标不对齐 → **要求用户确认**
- 检测到超出边界 → **要求用户确认**
- 检测到违背决策 → **直接拒绝执行**
- 检测到实现非目标 → **要求用户确认**

## 更新规则

### 必须更新的情况

1. 项目目标变化
2. 项目边界变化
3. 新增关键技术决策
4. 非目标列表变化

### 更新流程

1. 更新本文件
2. 通知相关技能书同步更新
3. 更新项目文档
4. 更新本文件的修改日期

---

**最后更新**: 2026-01-19
**维护者**: AI Assistant
